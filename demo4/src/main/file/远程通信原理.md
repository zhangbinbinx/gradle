# 远程通信协议原理

1. tcp/ip的三次握手和四次挥手是什么概念，以及状态变化过程？

   ```html
   tcp协议建立连接
     第一步 客户端发送连接请求，客户端状态为syn_sent状态并发送syn包
     第二步 服务端接收到客户端的连接请求，服务端状态为syn_rcvd并返回ack+syn数据包
     第三步 客户端接收到ack+syn数据包后，状态修改为estalished，并发送ack数据包
     第四步 服务器接收到ack数据包，状态修改为estalished连接成功
   tcp断开连接
     第一步 客户端进入fin_wait_1状态，并发送fin数据包
     第二步 服务器接收到fin数据包后，状态修改为close_wait,并发送ack数据包，客户端收到后状态为				fin_wait_2 
     第三步 服务器修改状态为last_ack,发送fin数据包，客户端接收到后状态为time_wait
     第四步 客户端发送ack数据包，服务器接收数据包后状态修改为close
   ```

   

2. 建立连接需要3次，为什么断开连接需要4次？

   ```html
   建立连接需要三次握手，服务端收到客户端的连接请求，可以直接发送SYN+ACK数据包。其中 ACK 报文是用来应答的， SYN 报文是用来同步的。
   断开连接时，当服务端收到 FIN数据包时，不能立即关闭SOCKET，需要先回复ack数据包给客户端。当服务端所有数据包发送完成后，发送fin数据包。
   ```

   

3. 三次握手有哪些不安全性？

   ```html
   服务端收到客户端的连接请求时，会进入半连接状态，占用资源并有可能会被攻击
   ```

   

4. TCP和UDP的区别？TCP是通过什么方式来保证可靠性的

   ```html
   tcp是面向连接的，消息可靠的，保证每条信息都会发送到，请求安全
   udp是无连接的，消息不可靠，但是执行速度快
   tcp通过校验和、序列号、确认应答、超时重传、连接管理、流量控制、拥塞控制一系列控制来保证连接的可靠性
   ```

   

5. tcp四层网络模型和osi七层网络模型分别是什么？以及每一层的作用

```html
tcp四层模型
应用层 		处理业务逻辑
传输层 		数据包的收发
网络层 		网络数据传输
数据链路层      数据在物理媒介上的传输	   
osi七层模型
应用层         文件传输
表示层			编码转换、数据解析
会话层			维持通信
传输层			数据包的收发
网络层			网络数据传输
数据链路层      数据在物理媒介上的传输	
物理层			管理物理设备的标准

```



1. 什么是滑动窗口协议？它的实现原理是什么？

   ```html
   是一种流量控制技术的协议，保证了数据传输的可靠性。
   通过限制在任何给定时间可以发送或接收的数据包的数量，滑动窗口协议允许使用固定大小的序列号传送无限数量的数据包。发送方侧的术语“窗口”表示接收方尚未确认的分组总数的逻辑边界。接收方在每个确认包中通知发送器当前的最大接收缓冲区大小（窗口边界）。 TCP报头使用16位字段向发送方报告接收窗口大小。
   ```

   

2. 服务器上TIME_WAIT状态的连接过多，怎么解决？

   ```html
   
   ```

   

3. 什么是NIO、BIO、AIO？他们的区别？

   ```html
   NIO 同步阻塞IO,一次只能执行一个任务
   BIO 同步分阻塞，可以在多个任务轮询执行
   AIO 异步分阻塞，通过事件的回调触发执行
   ```

   

4. 了解过多路复用吗？它是一个什么实现原理？

   ```html
   I/O多路复用（multiplexing）的本质是通过一种机制（系统内核缓冲I/O数据），让单个进程可以监视多个文件描述符，一旦某个描述符就绪（一般是读就绪或写就绪），能够通知程序进行相应的读写操作
   ```

   

5. epool和select的区别是什么？

   ```html
   通过调整内核参数解决：
   编辑文件/etc/sysctl.conf，加入以下内容：
   net.ipv4.tcp_syncookies = 1
   net.ipv4.tcp_tw_reuse = 1
   net.ipv4.tcp_tw_recycle = 1
   net.ipv4.tcp_fin_timeout = 30
   ```

   